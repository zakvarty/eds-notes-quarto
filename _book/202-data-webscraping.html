<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Effective Data Science - 5&nbsp; Web Scraping</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./203-data-apis.html" rel="next">
<link href="./201-data-tabular.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><link rel="stylesheet" href="style.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./200-data-introduction.html">Acquiring and Sharing Data</a></li><li class="breadcrumb-item"><a href="./202-data-webscraping.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Web Scraping</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Effective Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/zakvarty/eds-notes-quarto/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About this Course</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./100-workflows-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Effective Workflows</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./101-workflows-organising-your-work.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organising your work</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./102-workflows-naming-files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Naming Files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./103-workflows-organising-your-code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./110-workflows-checklist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workflows Checklist</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./200-data-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acquiring and Sharing Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./201-data-tabular.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tabular Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./202-data-webscraping.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Web Scraping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./203-data-apis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">APIs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./210-data-checklist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Checklist</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./300-edav-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Exploration and Visualisation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./301-edav-wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./302-edav-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./303-edav-visualisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Visualisation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./310-edav-checklist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Checklist</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./400-production-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preparing for Production</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./401-production-reproducibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Reproducibility</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./402-production-explainability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Explainability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./403-production-scalability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Scalability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./410-production-checklist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Checklist</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./500-ethics-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Ethics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./501-ethics-privacy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Privacy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./502-ethics-fairness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Fairness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./503-ethics-conduct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Codes of Conduct</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./510-ethics-checklist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Checklist</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#scraping-webpage-data-using-rvest" id="toc-scraping-webpage-data-using-rvest" class="nav-link active" data-scroll-target="#scraping-webpage-data-using-rvest"><span class="header-section-number">5.1</span> Scraping webpage data using {rvest}</a></li>
  <li><a href="#what-is-a-webpage" id="toc-what-is-a-webpage" class="nav-link" data-scroll-target="#what-is-a-webpage"><span class="header-section-number">5.2</span> What is a webpage?</a></li>
  <li>
<a href="#html" id="toc-html" class="nav-link" data-scroll-target="#html"><span class="header-section-number">5.3</span> HTML</a>
  <ul class="collapse">
<li><a href="#html-elements" id="toc-html-elements" class="nav-link" data-scroll-target="#html-elements"><span class="header-section-number">5.3.1</span> HTML elements</a></li>
  <li><a href="#important-html-elements" id="toc-important-html-elements" class="nav-link" data-scroll-target="#important-html-elements"><span class="header-section-number">5.3.2</span> Important HTML Elements</a></li>
  </ul>
</li>
  <li><a href="#html-attributes" id="toc-html-attributes" class="nav-link" data-scroll-target="#html-attributes"><span class="header-section-number">5.4</span> HTML Attributes</a></li>
  <li><a href="#css-selectors" id="toc-css-selectors" class="nav-link" data-scroll-target="#css-selectors"><span class="header-section-number">5.5</span> CSS Selectors</a></li>
  <li><a href="#which-attributes-and-selectors-do-you-need" id="toc-which-attributes-and-selectors-do-you-need" class="nav-link" data-scroll-target="#which-attributes-and-selectors-do-you-need"><span class="header-section-number">5.6</span> Which Attributes and Selectors Do You Need?</a></li>
  <li><a href="#reading-html-with-rvest" id="toc-reading-html-with-rvest" class="nav-link" data-scroll-target="#reading-html-with-rvest"><span class="header-section-number">5.7</span> Reading HTML with <code>{rvest}</code></a></li>
  <li><a href="#extracting-html-elements" id="toc-extracting-html-elements" class="nav-link" data-scroll-target="#extracting-html-elements"><span class="header-section-number">5.8</span> Extracting HTML elements</a></li>
  <li>
<a href="#extracting-data-from-html-elements" id="toc-extracting-data-from-html-elements" class="nav-link" data-scroll-target="#extracting-data-from-html-elements"><span class="header-section-number">5.9</span> Extracting Data From HTML Elements</a>
  <ul class="collapse">
<li><a href="#extracting-text" id="toc-extracting-text" class="nav-link" data-scroll-target="#extracting-text"><span class="header-section-number">5.9.1</span> Extracting text</a></li>
  <li><a href="#extracting-attributes" id="toc-extracting-attributes" class="nav-link" data-scroll-target="#extracting-attributes"><span class="header-section-number">5.9.2</span> Extracting Attributes</a></li>
  <li><a href="#extracting-tables" id="toc-extracting-tables" class="nav-link" data-scroll-target="#extracting-tables"><span class="header-section-number">5.9.3</span> Extracting tables</a></li>
  </ul>
</li>
  <li><a href="#tip-for-building-tibbles" id="toc-tip-for-building-tibbles" class="nav-link" data-scroll-target="#tip-for-building-tibbles"><span class="header-section-number">5.10</span> Tip for Building Tibbles</a></li>
  <li><a href="#session-information" id="toc-session-information" class="nav-link" data-scroll-target="#session-information"><span class="header-section-number">5.11</span> Session Information</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/zakvarty/eds-notes-quarto/edit/master/202-data-webscraping.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="data-webscraping" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Web Scraping</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Effective Data Science is still a work-in-progress. This chapter is largely complete and just needs final proof reading.</p>
<p>If you would like to contribute to the development of EDS, you may do so at <a href="https://github.com/zakvarty/data_science_notes" class="uri">https://github.com/zakvarty/data_science_notes</a>.</p>
</div>
</div>
<section id="scraping-webpage-data-using-rvest" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="scraping-webpage-data-using-rvest">
<span class="header-section-number">5.1</span> Scraping webpage data using {rvest}</h2>
<div class="small_right">
<p><img style="border-radius: 10%;" src="images/202-data-webscraping/rvest-logo.png" alt="Hexagonal logo of the rvest package; a sickle cutting wheat on a red background."></p>
</div>
<p>You can’t always rely on tidy, tabular data to land on your desk. Sometimes you are going to have to go out and gather data for yourself.</p>
<p>I’m not suggesting you will need to do this manually, but you will likely need to get data from the internet that’s been made publicly or privately available to you.</p>
<p>This might be information from a webpage that you gather yourself, or data shared with you by a collaborator using an API.</p>
<p>In this chapter we will cover the basics of scraping webpages, following the <a href="https://cran.r-project.org/web/packages/rvest/vignettes/rvest.html#fnref3">vignette</a> for the {rvest} package.</p>
</section><section id="what-is-a-webpage" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="what-is-a-webpage">
<span class="header-section-number">5.2</span> What is a webpage?</h2>
<p>Before we can even hope to get data from a webpage, we first need to understand <em>what</em> a webpage is.</p>
<p>Webpages are written in a similar way to LaTeX: the content and styling of webpages are handled separately and are coded using plain text files.</p>
<p>In fact, websites go one step further than LaTeX. The content and styling of websites are written in different files and in different languages. HTML (HyperText Markup Language) is used to write the content and then CSS (Cascading Style Sheets) are used to control the appearance of that content when it’s displayed to the user.</p>
</section><section id="html" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="html">
<span class="header-section-number">5.3</span> HTML</h2>
<p>A basic HTML page with no styling applied might look something like this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;head&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;title&gt;</span>Page title<span class="kw">&lt;/title&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;body&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;h1</span> <span class="er">id</span><span class="ot">=</span><span class="st">'first'</span><span class="kw">&gt;</span>A level 1 heading<span class="kw">&lt;/h1&gt;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;p&gt;</span>Hello World!<span class="kw">&lt;/p&gt;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;p&gt;</span>Here is some plain text <span class="dv">&amp;amp;</span> <span class="kw">&lt;b&gt;</span>some bold text.<span class="kw">&lt;/b&gt;&lt;/p&gt;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;img</span> <span class="er">src</span><span class="ot">=</span><span class="st">'myimg.png'</span> <span class="er">width</span><span class="ot">=</span><span class="st">'100'</span> <span class="er">height</span><span class="ot">=</span><span class="st">'100'</span><span class="kw">&gt;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/body&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="html-elements" class="level3" data-number="5.3.1"><h3 data-number="5.3.1" class="anchored" data-anchor-id="html-elements">
<span class="header-section-number">5.3.1</span> HTML elements</h3>
<!-- for presentation 
```{.html}
#| code-line-numbers: "3"
<html>
<head>
  <title>Page title</title>
</head>
<body>
  <h1 id='first'>A level 1 heading</h1>
  <p>Hello World!</p>
  <p>Here is some plain text &amp; <b>some bold text.</b></p>
  <img src='myimg.png' width='100' height='100'>
</body>
```
-->
<p>Just like XML data files, HTML has a hierarchical structure. This structure is crafted using HTML elements. Each HTML element is made up of of a start tag, optional attributes, an end tag.</p>
<p>We can see each of these in the first level header, where <code>&lt;h1&gt;</code> is the opening tag, <code>id='first'</code> is an additional attribute and <code>&lt;/h1&gt;</code> is the closing tag. Everything between the opening and closing tag are the contents of that element. There are also some special elements that consist of only a single tag and its optional attributes. An example of this is the <code>&lt;img&gt;</code> tag.</p>
<p>Since <code>&lt;</code> and <code>&gt;</code> are used for start and end tags, you can’t write them directly in an HTML document. Instead, you have to use escape characters. This sounds fancy, but it’s just an alternative way to write characters that serve some special function within a language.</p>
<p>You can write greater than <code>&amp;gt;</code> and less than as <code>&amp;lt;</code>. You might notice that those escapes use an ampersand (&amp;). This means that if you want a literal ampersand on your webpage, you have to escape too using <code>&amp;amp;</code>.</p>
<p>There are a wide range of possible HTML tags and escapes. We’ll cover the most common tags in this lecture and you don’t need to worry about escapes too much because <a href="https://rvest.tidyverse.org/">rvest</a> will automatically handle them for you.</p>
</section><section id="important-html-elements" class="level3" data-number="5.3.2"><h3 data-number="5.3.2" class="anchored" data-anchor-id="important-html-elements">
<span class="header-section-number">5.3.2</span> Important HTML Elements</h3>
<p>In all, there are in excess of 100 HTML elements. The most important ones for you to know about are:</p>
<ul>
<li><p>The <code>&lt;html&gt;</code> element, that must enclose every HTML page. The <code>&lt;html&gt;</code> element must have two child elements within it. The <code>&lt;head&gt;</code> element contains metadata about the document, like the page title that is shown in the browser tab and the CSS style sheet that should be applied. The <code>&lt;body&gt;</code> element then contains all of the content that you see in the browser.</p></li>
<li><p>Block elements are used to give structure to the page. These are elements like headings, sub-headings and so on from <code>&lt;h1&gt;</code> all the way down to <code>&lt;h6&gt;</code>. This category also contains paragraph elements <code>&lt;p&gt;</code>, ordered lists <code>&lt;ol&gt;</code> unordered lists <code>&lt;ul&gt;</code>.</p></li>
<li><p>Finally, inline tags like <code>&lt;b&gt;</code> for bold, <code>&lt;i&gt;</code> for italics, and <code>&lt;a&gt;</code> for hyperlinks are used to format text inside block elements.</p></li>
</ul>
<p>When you come across a tag that you’ve never seen before, you can find out what it does with just a little bit of googling. A good resource here is the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML">MDN Web Docs</a> which are produced by Mozilla, the company that makes the Firefox web browser. The <a href="https://www.w3schools.com/html/default.asp">W3schools website</a> is another great resource for web development and coding resources more generally.</p>
</section></section><section id="html-attributes" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="html-attributes">
<span class="header-section-number">5.4</span> HTML Attributes</h2>
<p>We’ve seen one example of a header with an additional attribute. More generally, all tags can have named attributes. These attributes are contained within the opening tag and look something like:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;tag</span> <span class="er">attribute1</span><span class="ot">=</span><span class="st">'value1'</span> <span class="er">attribute2</span><span class="ot">=</span><span class="st">'value2'</span><span class="kw">&gt;</span>element contents<span class="kw">&lt;/tag&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Two of the most important attributes are <code>id</code> and <code>class</code>. These attributes are used in conjunction with the CSS file to control the visual appearance of the page. These are often very useful to identify the elements that you are interested in when scraping data off a page.</p>
</section><section id="css-selectors" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="css-selectors">
<span class="header-section-number">5.5</span> CSS Selectors</h2>
<p>The Cascading Style Sheet is used to describe how your HTML content will be displayed. To do this, CSS has it’s own system for selecting elements of a webpage, called CSS selectors.</p>
<p>CSS selectors define patterns for locating the HTML elements that a particular style should be applied to. A happy side-effect of this is that they can sometimes be very useful for scraping, because they provide a concise way of describing which elements you want to extract.</p>
<p>CSS Selectors can work on the level of an element type, a class, or a tag and these can be used in a nested (or <em>cascading</em>) way.</p>
<ul>
<li><p>The <code>p</code> selector will select all paragraph <code>&lt;p&gt;</code> elements.</p></li>
<li><p>The <code>.title</code> selector will select all elements with class <code>“title”</code>.</p></li>
<li><p>The <code>p.special</code> selector will select all<code>&lt;p&gt;</code> elements with class <code>“special”</code>.</p></li>
<li><p>The <code>#title</code> selector will select the element with the id attribute <code>“title”</code>.</p></li>
</ul>
<p>When you want to select a single element <code>id</code> attributes are particularly useful because that <em>must</em> be unique within a html document. Unfortunately, this is only helpful if the developer added an <code>id</code> attribute to the element(s) you want to scrape!</p>
<p>If you want to learn more CSS selectors I recommend starting with the fun <a href="https://flukeout.github.io/">CSS diner tutorial</a> to build a base of knowledge and then using the <a href="https://www.w3schools.com/css/default.asp">W3schools resources</a> as a reference to explore more webpages in the wild.</p>
</section><section id="which-attributes-and-selectors-do-you-need" class="level2" data-number="5.6"><h2 data-number="5.6" class="anchored" data-anchor-id="which-attributes-and-selectors-do-you-need">
<span class="header-section-number">5.6</span> Which Attributes and Selectors Do You Need?</h2>
<p>To scrape data from a webpage, you first have to identify the tag and attribute combinations that you are interested in gathering.</p>
<p>To find your elements of interest, you have three options. These go from hardest to easiest but also from most to least robust.</p>
<ul>
<li>right click + “inspect page source” (F12)</li>
<li>right click + “inspect”</li>
<li>Rvest <a href="https://rvest.tidyverse.org/articles/selectorgadget.html">Selector Gadget</a> (very useful but fallible)</li>
</ul>
<p>Inspecting the source of some familiar websites can be a useful way to get your head around these concepts. Beware though that sophisticated webpages can be quite intimidating. A good place to start is with simpler, static websites such as personal websites, rather than the dynamic webpages of online retailers or social media platforms.</p>
</section><section id="reading-html-with-rvest" class="level2" data-number="5.7"><h2 data-number="5.7" class="anchored" data-anchor-id="reading-html-with-rvest">
<span class="header-section-number">5.7</span> Reading HTML with <code>{rvest}</code>
</h2>
<p>With <a href="https://rvest.tidyverse.org/">rvest</a>, reading a html page can be as simple as loading in tabular data.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">html</span> <span class="op">&lt;-</span> <span class="fu">rvest</span><span class="fu">::</span><span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html">read_html</a></span><span class="op">(</span><span class="st">"https://www.zakvarty.com/professional/teaching.html"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>class</code> of the resulting object is an <code>xml_document</code>. This type of object is from the low-level package <a href="https://xml2.r-lib.org/">xml2</a>, which allows you to read xml files into R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">html</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "xml_document" "xml_node"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can see that this object is split into several components: first is some metadata on the type of document we have scraped, followed by the head and then the body of that html document.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">html</span></span>
<span><span class="co">#&gt; {html_document}</span></span>
<span><span class="co">#&gt; &lt;html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"&gt;</span></span>
<span><span class="co">#&gt; [1] &lt;head&gt;\n&lt;meta http-equiv="Content-Type" content="text/html; charset=UT ...</span></span>
<span><span class="co">#&gt; [2] &lt;body class="nav-fixed"&gt;\n\n&lt;div id="quarto-search-results"&gt;&lt;/div&gt;\n   ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have several possible approaches to extracting information from this document.</p>
</section><section id="extracting-html-elements" class="level2" data-number="5.8"><h2 data-number="5.8" class="anchored" data-anchor-id="extracting-html-elements">
<span class="header-section-number">5.8</span> Extracting HTML elements</h2>
<p>In <a href="https://rvest.tidyverse.org/">rvest</a> you can extract a single element with <code><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element()</a></code>, or all matching elements with <code><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements()</a></code>. Both functions take a document object and one or more CSS selectors as inputs.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rvest.tidyverse.org/">rvest</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">html</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span><span class="st">"h1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; {xml_nodeset (1)}</span></span>
<span><span class="co">#&gt; [1] &lt;h1&gt;Teaching&lt;/h1&gt;</span></span>
<span><span class="va">html</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span><span class="st">"h2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; {xml_nodeset (2)}</span></span>
<span><span class="co">#&gt; [1] &lt;h2 id="toc-title"&gt;On this page&lt;/h2&gt;</span></span>
<span><span class="co">#&gt; [2] &lt;h2 class="anchored" data-anchor-id="course-history"&gt;Course History&lt;/h2&gt;</span></span>
<span><span class="va">html</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span><span class="st">"p"</span><span class="op">)</span></span>
<span><span class="co">#&gt; {xml_nodeset (7)}</span></span>
<span><span class="co">#&gt; [1] &lt;p&gt;I am fortunate to have had the opportunity to teach in a variety of ...</span></span>
<span><span class="co">#&gt; [2] &lt;p&gt;Developing and teaching a number of modules in statistics, data sci ...</span></span>
<span><span class="co">#&gt; [3] &lt;p&gt;Supervising undergraduate, postgraduate and doctoral research proje ...</span></span>
<span><span class="co">#&gt; [4] &lt;p&gt;Adapting and leading short courses on scientific writing and commun ...</span></span>
<span><span class="co">#&gt; [5] &lt;p&gt;Running workshops and computer labs for undergraduate and postgradu ...</span></span>
<span><span class="co">#&gt; [6] &lt;p&gt;Speaking at univerisity open days and providing one-to-one tuition  ...</span></span>
<span><span class="co">#&gt; [7] &lt;p&gt;I am an associate fellow of the Higher Education Academy, which you ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also combine and nest these selectors. For example you might want to extract all links that are within paragraphs <em>and</em> all second level headers.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">html</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span><span class="st">"p a,h2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; {xml_nodeset (3)}</span></span>
<span><span class="co">#&gt; [1] &lt;h2 id="toc-title"&gt;On this page&lt;/h2&gt;</span></span>
<span><span class="co">#&gt; [2] &lt;a href="https://www.advance-he.ac.uk/fellowship/associate-fellowship" ...</span></span>
<span><span class="co">#&gt; [3] &lt;h2 class="anchored" data-anchor-id="course-history"&gt;Course History&lt;/h2&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="extracting-data-from-html-elements" class="level2" data-number="5.9"><h2 data-number="5.9" class="anchored" data-anchor-id="extracting-data-from-html-elements">
<span class="header-section-number">5.9</span> Extracting Data From HTML Elements</h2>
<p>Now that we’ve got the elements we care about extracted from the complete document. But how do we get the data we need out of those elements?</p>
<p>You’ll usually get the data from either the contents of the HTML element or else from one of it’s attributes. If you’re really lucky, the data you need will already be formatted for you as a HTML table or list.</p>
<section id="extracting-text" class="level3" data-number="5.9.1"><h3 data-number="5.9.1" class="anchored" data-anchor-id="extracting-text">
<span class="header-section-number">5.9.1</span> Extracting text</h3>
<p>The functions <code><a href="https://rvest.tidyverse.org/reference/html_text.html">rvest::html_text()</a></code> and <code><a href="https://rvest.tidyverse.org/reference/html_text.html">rvest::html_text2()</a></code> can be used to extract the plain text contents of an HTML element.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">html</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span><span class="st">"#teaching li"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text2</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Developing and teaching a number of modules in statistics, data science and data ethics. These were predominantly at the postgradute-level and include courses designed for in-person and remote learning."</span></span>
<span><span class="co">#&gt; [2] "Supervising undergraduate, postgraduate and doctoral research projects."                                                                                                                                   </span></span>
<span><span class="co">#&gt; [3] "Adapting and leading short courses on scientific writing and communication."                                                                                                                               </span></span>
<span><span class="co">#&gt; [4] "Running workshops and computer labs for undergraduate and postgraduate modules."                                                                                                                           </span></span>
<span><span class="co">#&gt; [5] "Speaking at univerisity open days and providing one-to-one tuition to high school students."</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The difference between <code><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text()</a></code> and <code><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text2()</a></code> is in how they handle whitespace. In HTML whitespace and line breaks have very little influence over how the code is interpreted by the computer (this is similar to R but very different from Python). <code><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text()</a></code> will extract the text as it is in the raw html, while <code><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text2()</a></code> will do its best to extract the text in a way that gives you something similar to what you’d see in the browser.</p>
</section><section id="extracting-attributes" class="level3" data-number="5.9.2"><h3 data-number="5.9.2" class="anchored" data-anchor-id="extracting-attributes">
<span class="header-section-number">5.9.2</span> Extracting Attributes</h3>
<p>Attributes are also used to record information that you might like to collect. For example, the destination of links are stored in the <code>href</code> attribute and the source of images is stored in the <code>src</code> attribute.</p>
<p>As an example of this, consider trying to extract the twitter link from the icon in the page footer. This is quite tricky to locate in the html source, so I used the <a href="https://rvest.tidyverse.org/articles/selectorgadget.html">Selector Gadget</a> to help find the correct combination of elements.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">html</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element</a></span><span class="op">(</span><span class="st">".compact:nth-child(1) .nav-link"</span><span class="op">)</span></span>
<span><span class="co">#&gt; {html_node}</span></span>
<span><span class="co">#&gt; &lt;a class="nav-link" href="https://www.twitter.com/zakvarty"&gt;</span></span>
<span><span class="co">#&gt; [1] &lt;i class="bi bi-twitter" role="img"&gt;\n&lt;/i&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To extract the <code>href</code> attribute from the scraped element, we use the <code><a href="https://rvest.tidyverse.org/reference/html_attr.html">rvest::html_attr()</a></code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">html</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span><span class="st">".compact:nth-child(1) .nav-link"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_attr.html">html_attr</a></span><span class="op">(</span><span class="st">"href"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "https://www.twitter.com/zakvarty"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Note:</strong> <code><a href="https://rvest.tidyverse.org/reference/html_attr.html">rvest::html_attr()</a></code> will always return a character string (or list of character strings). If you are extracting an attribute that describes a quantity, such as the width of an image, you’ll need to convert this from a string to your required data type. For example, of the width is measures in pixels you might use <code><a href="https://rdrr.io/r/base/integer.html">as.integer()</a></code>.</p>
</section><section id="extracting-tables" class="level3" data-number="5.9.3"><h3 data-number="5.9.3" class="anchored" data-anchor-id="extracting-tables">
<span class="header-section-number">5.9.3</span> Extracting tables</h3>
<p>HTML tables are composed in a similar, nested manner to LaTeX tables.</p>
<p>There are four main elements to know about that make up an HTML table:</p>
<ul>
<li>
<code>&lt;table&gt;</code>,</li>
<li>
<code>&lt;tr&gt;</code> (table row),</li>
<li>
<code>&lt;th&gt;</code> (table heading),</li>
<li>
<code>&lt;td&gt;</code> (table data).</li>
</ul>
<p>Here’s our simple example data, formatted as an HTML table:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">html_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/minimal_html.html">minimal_html</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  &lt;table&gt;</span></span>
<span><span class="st">    &lt;tr&gt;</span></span>
<span><span class="st">      &lt;th&gt;Name&lt;/th&gt;</span></span>
<span><span class="st">      &lt;th&gt;Number&lt;/th&gt;</span></span>
<span><span class="st">    &lt;/tr&gt;</span></span>
<span><span class="st">    &lt;tr&gt;</span></span>
<span><span class="st">      &lt;td&gt;A&lt;/td&gt;</span></span>
<span><span class="st">      &lt;td&gt;1&lt;/td&gt;</span></span>
<span><span class="st">    &lt;/tr&gt;</span></span>
<span><span class="st">    &lt;tr&gt;</span></span>
<span><span class="st">      &lt;td&gt;B&lt;/td&gt;</span></span>
<span><span class="st">      &lt;td&gt;2&lt;/td&gt;</span></span>
<span><span class="st">    &lt;/tr&gt;</span></span>
<span><span class="st">    &lt;tr&gt;</span></span>
<span><span class="st">      &lt;td&gt;C&lt;/td&gt;</span></span>
<span><span class="st">      &lt;td&gt;3&lt;/td&gt;</span></span>
<span><span class="st">    &lt;/tr&gt;</span></span>
<span><span class="st">  &lt;/table&gt;</span></span>
<span><span class="st">  "</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since tables are a common way to store data, <a href="https://rvest.tidyverse.org/">rvest</a> includes a useful function <code><a href="https://rvest.tidyverse.org/reference/html_table.html">html_table()</a></code> that converts directly from an HTML table into a tibble.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">html_2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element</a></span><span class="op">(</span><span class="st">"table"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_table.html">html_table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span><span class="co">#&gt;   Name  Number</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 A          1</span></span>
<span><span class="co">#&gt; 2 B          2</span></span>
<span><span class="co">#&gt; 3 C          3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Applying this to our real scraped data we can easily extract the table of taught courses.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">html</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element</a></span><span class="op">(</span><span class="st">"table"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_table.html">html_table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 31 × 3</span></span>
<span><span class="co">#&gt;   Year      Course                                     Role    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;                                      &lt;chr&gt;   </span></span>
<span><span class="co">#&gt; 1 "2022-23" Data Science                               Lecturer</span></span>
<span><span class="co">#&gt; 2 ""        Ethics in Data Science I, II and III       Lecturer</span></span>
<span><span class="co">#&gt; 3 ""        Data Ethics for Digital Chemistry          Lecturer</span></span>
<span><span class="co">#&gt; 4 ""        Y1 research projects: point process models Lecturer</span></span>
<span><span class="co">#&gt; 5 "2021-22" Supervised Learning                        Lecturer</span></span>
<span><span class="co">#&gt; 6 ""        Ethics in Data Science I                   Lecturer</span></span>
<span><span class="co">#&gt; # ℹ 25 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="tip-for-building-tibbles" class="level2" data-number="5.10"><h2 data-number="5.10" class="anchored" data-anchor-id="tip-for-building-tibbles">
<span class="header-section-number">5.10</span> Tip for Building Tibbles</h2>
<p>When scraping data from a webpage, your end-goal is typically going to be constructing a data.frame or a tibble.</p>
<p>If you are following our description of tidy data, you’ll want each row to correspond some repeated unit on the HTML page. In this case, you should</p>
<ol type="1">
<li>Use <code><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements()</a></code> to select the elements that contain each observation unit;</li>
<li>Use <code><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element()</a></code> to extract the variables from each of those observations.</li>
</ol>
<p>Taking this approach guarantees that you’ll get the same number of values for each variable, because <code><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element()</a></code> always returns the same number of outputs as inputs. This is vital when you have missing data - when not every observation unit has a value for every variable of interest.</p>
<p>As an example, consider this extract of text about the <a href="https://dplyr.tidyverse.org/reference/starwars.html#ref-examples">starwars dataset</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">starwars_html</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/minimal_html.html">minimal_html</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  &lt;ul&gt;</span></span>
<span><span class="st">    &lt;li&gt;&lt;b&gt;C-3PO&lt;/b&gt; is a &lt;i&gt;droid&lt;/i&gt; that weighs &lt;span class='weight'&gt;167 kg&lt;/span&gt;&lt;/li&gt;</span></span>
<span><span class="st">    &lt;li&gt;&lt;b&gt;R2-D2&lt;/b&gt; is a &lt;i&gt;droid&lt;/i&gt; that weighs &lt;span class='weight'&gt;96 kg&lt;/span&gt;&lt;/li&gt;</span></span>
<span><span class="st">    &lt;li&gt;&lt;b&gt;Yoda&lt;/b&gt; weighs &lt;span class='weight'&gt;66 kg&lt;/span&gt;&lt;/li&gt;</span></span>
<span><span class="st">    &lt;li&gt;&lt;b&gt;R4-P17&lt;/b&gt; is a &lt;i&gt;droid&lt;/i&gt;&lt;/li&gt;</span></span>
<span><span class="st">  &lt;/ul&gt;</span></span>
<span><span class="st">  "</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is an unordered list where each list item corresponds to one observational unit (one character from the starwars universe). The name of the character is given in bold, the character species is specified in italics and the weight of the character is denoted by the <code>.weight</code> class. However, some characters have only a subset of these variables defined: for example Yoda has no species entry.</p>
<p>If we try to extract each element directly, our vectors of variable values are of different lengths. We don’t know where the missing values should be, so we can’t line them back up to make a tibble.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">starwars_html</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span><span class="st">"b"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text2</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "C-3PO"  "R2-D2"  "Yoda"   "R4-P17"</span></span>
<span><span class="va">starwars_html</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span><span class="st">"i"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text2</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "droid" "droid" "droid"</span></span>
<span><span class="va">starwars_html</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span><span class="st">".weight"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text2</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "167 kg" "96 kg"  "66 kg"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What we should do instead is start by extracting all of the list item elements using <code><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements()</a></code>. Once we have done this, we can then use <code><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element()</a></code> to extract each variable for all characters. This will pad with NAs, so that we can collate them into a tibble.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">starwars_characters</span> <span class="op">&lt;-</span> <span class="va">starwars_html</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span><span class="st">"li"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">starwars_characters</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element</a></span><span class="op">(</span><span class="st">"b"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text2</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "C-3PO"  "R2-D2"  "Yoda"   "R4-P17"</span></span>
<span><span class="va">starwars_characters</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element</a></span><span class="op">(</span><span class="st">"i"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text2</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "droid" "droid" NA      "droid"</span></span>
<span><span class="va">starwars_characters</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element</a></span><span class="op">(</span><span class="st">".weight"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text2</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "167 kg" "96 kg"  "66 kg"  NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="va">starwars_characters</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element</a></span><span class="op">(</span><span class="st">"b"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text2</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  species <span class="op">=</span> <span class="va">starwars_characters</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element</a></span><span class="op">(</span><span class="st">"i"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text2</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="va">starwars_characters</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element</a></span><span class="op">(</span><span class="st">".weight"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text2</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span><span class="co">#&gt;   name   species weight</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; </span></span>
<span><span class="co">#&gt; 1 C-3PO  droid   167 kg</span></span>
<span><span class="co">#&gt; 2 R2-D2  droid   96 kg </span></span>
<span><span class="co">#&gt; 3 Yoda   &lt;NA&gt;    66 kg </span></span>
<span><span class="co">#&gt; 4 R4-P17 droid   &lt;NA&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="session-information" class="level2" data-number="5.11"><h2 data-number="5.11" class="anchored" data-anchor-id="session-information">
<span class="header-section-number">5.11</span> Session Information</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<p><strong>R version 4.2.2 (2022-10-31)</strong></p>
<p><strong>Platform:</strong> x86_64-apple-darwin17.0 (64-bit)</p>
<p><strong>locale:</strong> en_US.UTF-8||en_US.UTF-8||en_US.UTF-8||C||en_US.UTF-8||en_US.UTF-8</p>
<p><strong>attached base packages:</strong> <em>stats</em>, <em>graphics</em>, <em>grDevices</em>, <em>datasets</em>, <em>utils</em>, <em>methods</em> and <em>base</em></p>
<p><strong>other attached packages:</strong> rvest(v.1.0.3)</p>
<p><strong>loaded via a namespace (and not attached):</strong> <em>Rcpp(v.1.0.11)</em>, <em>rstudioapi(v.0.15.0)</em>, <em>knitr(v.1.43)</em>, <em>xml2(v.1.3.5)</em>, <em>magrittr(v.2.0.3)</em>, <em>R6(v.2.5.1)</em>, <em>rlang(v.1.1.1)</em>, <em>fastmap(v.1.1.1)</em>, <em>fansi(v.1.0.4)</em>, <em>stringr(v.1.5.0)</em>, <em>httr(v.1.4.6)</em>, <em>tools(v.4.2.2)</em>, <em>xfun(v.0.39)</em>, <em>utf8(v.1.2.3)</em>, <em>cli(v.3.6.1)</em>, <em>selectr(v.0.4-2)</em>, <em>htmltools(v.0.5.5)</em>, <em>yaml(v.2.3.7)</em>, <em>digest(v.0.6.33)</em>, <em>tibble(v.3.2.1)</em>, <em>lifecycle(v.1.0.3)</em>, <em>htmlwidgets(v.1.6.2)</em>, <em>vctrs(v.0.6.3)</em>, <em>curl(v.5.0.1)</em>, <em>glue(v.1.6.2)</em>, <em>evaluate(v.0.21)</em>, <em>rmarkdown(v.2.23)</em>, <em>stringi(v.1.7.12)</em>, <em>pander(v.0.6.5)</em>, <em>pillar(v.1.9.0)</em>, <em>compiler(v.4.2.2)</em>, <em>jsonlite(v.1.8.7)</em>, <em>renv(v.0.16.0)</em> and <em>pkgconfig(v.2.0.3)</em></p>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./201-data-tabular.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tabular Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./203-data-apis.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">APIs</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>